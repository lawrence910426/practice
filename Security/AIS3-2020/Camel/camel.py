# 759211060281786031869071242155234136314844944 = -1 + a + b
# 1057401451679095062531151979389760885573147826 = 1 + a + b
# 1057401451679095062531151979389760885573147826 - 759211060281786031869071242155234136314844944 = 2 (mod p)
import math
a = 1057401451679095062531151979389760885573147826 ** 2 + 759211060281786031869071242155234136314844944 ** 2
b = 155419950529021753751813670756068418661489493 ** 2 + 773808304364278082418521288269860813684230337 ** 2
c = 410837747859871710141162996756729573836835781 ** 2 + 812270051867990261460153809983232723732262237 ** 2
n = 1057401451679095062531151979389760885573147826
x, y, z = abs(a // 2 - b // 2), abs(b // 2 - c // 2), abs(a // 2 - c // 2)


# print(a, b, c)
# print(a // 2, b // 2, c // 2)
# print(x, y)

P = math.gcd(x, y)
B = a * pow(2, P - 2, P) % P
A = (n ** 2 - 1 ** 3 - B) % P

print("p: ", hex(P))
print("b: ", hex(B))
print("a: ", hex(A))

print("Flag: ", bytes.fromhex(hex(A)[2:] + hex(B)[2:] + hex(P)[2:]))
